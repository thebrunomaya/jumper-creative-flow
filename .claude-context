# Claude Code Context File
# Auto-managed by Claude Code sessions
# Tracks recent decisions and work-in-progress (last 7 days)
# Older decisions migrate to docs/ARCHITECTURE.md

last_updated: "2024-12-13T23:00:00Z"
session_computer: "MacBook Pro"
session_user: "Bruno Maya"

# Recent decisions (last 7 days)
# When older than 7 days, migrate to docs/ARCHITECTURE.md
recent_decisions:
  - date: "2024-12-13"
    decision: "CreativeDetailModal - Modal completo ao clicar no card"
    status: "complete ‚úÖ"
    details: |
      üéØ CREATIVE DETAIL MODAL - SESS√ÉO 2024-12-13

      ## Features Implementadas (v2.1.91 - v2.1.99):

      ### 1. Modal de Detalhes do Criativo
      - Click no TopCreativeCard abre modal com todas as informa√ß√µes
      - Thumbnail em destaque (1:1 aspect ratio)
      - T√≠tulo, body, campanha, badges de tipo
      - Links externos (Ver no Facebook, Ver no Instagram)

      ### 2. M√©tricas Consolidadas (8 m√©tricas)
      - Gasto, ROAS, Compras, Receita
      - Impress√µes, Cliques, CTR, CPC
      - Todos com √≠cones consistentes
      - Tooltips explicativos para clientes (hover)

      ### 3. Inst√¢ncias do Criativo (breakdown)
      - Lista todas as ads que usam o mesmo creative_id
      - Campanha + Conjunto de An√∫ncios vis√≠veis
      - M√©tricas individuais por inst√¢ncia
      - Tooltips em cada m√©trica

      ### 4. Alertas Visuais
      - CTR < 1% ‚Üí alerta amarelo ‚ö†Ô∏è
      - CPC > R$ 1,50 ‚Üí alerta laranja ‚ö†Ô∏è
      - ROAS < 1x ‚Üí vermelho / ‚â• 1x ‚Üí verde

      ### 5. Agrega√ß√£o por creative_id
      - Corrigido: agora agrupa por creative_id (n√£o ad_id)
      - M√©tricas consolidadas refletem performance real do criativo
      - Exemplo: "Jumping Era" com 2 inst√¢ncias mostra ROAS 1.17x (correto)

    impact: "MAJOR - Nova experi√™ncia de an√°lise de criativos"
    files_changed:
      - "src/components/dashboards/CreativeDetailModal.tsx (NEW)"
      - "src/hooks/useCreativeInstances.ts (NEW)"
      - "src/components/dashboards/TopCreativeCard.tsx (modified)"
      - "src/components/dashboards/TopCreativesSection.tsx (modified)"
      - "src/hooks/useTopCreatives.ts (modified - creative_id aggregation)"
      - "docs/ROADMAP-DASHBOARDS.md (updated)"
    deployed: true
    deployment_status: "Deployed v2.1.99 ‚úÖ"
    commits:
      - "cce5db3: fix(modal): Tooltip overflow v2 - sticky positioning (v2.1.99)"
      - "8924691: fix(modal): Tooltip overflow - bottom side (v2.1.98)"
      - "c0f3cff: enh(modal): Add metric tooltips and icons (v2.1.97)"
      - "6bd4c4d: enh(modal): Adjust CPC threshold to R$1.50 (v2.1.96)"
      - "9466591: enh(modal): CTR/CPC alerts in consolidated metrics (v2.1.95)"
      - "adb865c: enh(modal): Campaign/Adset in instances (v2.1.94)"
    migrate_to_architecture: false

# Current issues being worked on
current_issues:
  - issue: "Tooltip overflow em algumas posi√ß√µes do modal"
    status: "mitigated"
    details: "Implementado sticky='always' e max-w-[200px]. Pode precisar ajuste fino."
    priority: "low"
    next_action: "Monitorar feedback do usu√°rio"

# Work in progress
work_in_progress:
  - feature: "Top 3 Criativos + Modal de Detalhes"
    status: "complete"
    completed:
      - "‚úÖ Componentes base (cards com medalhas)"
      - "‚úÖ Hook useTopCreatives com agrega√ß√£o por creative_id"
      - "‚úÖ Sistema de Thumbnails Permanentes"
      - "‚úÖ CreativeDetailModal com m√©tricas consolidadas"
      - "‚úÖ useCreativeInstances hook"
      - "‚úÖ Tooltips explicativos para clientes"
      - "‚úÖ Alertas de CTR/CPC fora do alvo"
    pending:
      - "‚è≥ Rollout para outros 11 dashboards"

# Context for next session
next_session_context: |
  üéØ SESSION 2024-12-13 COMPLETED: CREATIVE DETAIL MODAL

  ## ‚úÖ O QUE FOI FEITO HOJE (v2.1.91 ‚Üí v2.1.99):

  **Modal de Detalhes:**
  - ‚úÖ Click no card abre modal completo
  - ‚úÖ M√©tricas Consolidadas (8 m√©tricas com √≠cones)
  - ‚úÖ Inst√¢ncias do Criativo (breakdown por ad_id)
  - ‚úÖ Tooltips explicativos em TODAS as m√©tricas
  - ‚úÖ Alertas visuais (CTR < 1%, CPC > R$ 1,50)
  - ‚úÖ Links FB/IG movidos para o modal
  - ‚úÖ Scroll funcionando corretamente

  **Agrega√ß√£o Corrigida:**
  - ‚úÖ useTopCreatives agora agrupa por creative_id (n√£o ad_id)
  - ‚úÖ M√©tricas refletem performance real do criativo

  **Thresholds Baseados em:**
  - ROAS alvo: 5x
  - Ticket m√©dio: R$ 180
  - Taxa de convers√£o: 1%
  - CPC m√°ximo ideal: R$ 0,36 (alerta em R$ 1,50)

  ## üìã PR√ìXIMA SESS√ÉO:

  1. Rollout TopCreativesSection para outros dashboards:
     - TrafficDashboard, LeadsDashboard, EngagementDashboard
     - BrandAwarenessDashboard, ReachDashboard, etc.

  2. Considerar melhorias opcionais:
     - Tooltip positioning edge cases
     - Mais m√©tricas no modal (CPM, Alcance, etc.)

  ## üìÅ ARQUIVOS IMPORTANTES:

  - Modal: `src/components/dashboards/CreativeDetailModal.tsx`
  - Hook inst√¢ncias: `src/hooks/useCreativeInstances.ts`
  - Roadmap: `docs/ROADMAP-DASHBOARDS.md`

# TODOs pending
pending_todos:
  - "Rollout TopCreativesSection para outros 11 dashboards"
  - "Monitorar tooltip overflow edge cases"

# Recently completed (for reference)
completed_recently:
  - "‚úÖ [2024-12-13 23:00] CreativeDetailModal com tooltips (v2.1.99)"
  - "‚úÖ [2024-12-13 22:45] Alertas CTR/CPC nas m√©tricas consolidadas"
  - "‚úÖ [2024-12-13 22:30] Threshold CPC ajustado para R$ 1,50"
  - "‚úÖ [2024-12-13 22:00] Tooltips explicativos para clientes"
  - "‚úÖ [2024-12-13 21:30] useCreativeInstances hook criado"
  - "‚úÖ [2024-12-13 21:00] CreativeDetailModal implementado"
  - "‚úÖ [2024-12-13 20:30] Agrega√ß√£o por creative_id corrigida"

# Deployment status
deployment:
  production_url: "https://hub.jumper.studio"
  current_version: "v2.1.99"
  last_deploy: "2024-12-13T23:00:00Z"
  last_deploy_status: "CreativeDetailModal deployed ‚úÖ"
  last_commit: "cce5db3 - fix(modal): Tooltip overflow v2"
  database_status: "STABLE"
  known_issues: "Tooltip pode ter overflow em edge cases (mitigado)"
  recent_commits:
    - "cce5db3: fix(modal): Tooltip overflow v2 (v2.1.99)"
    - "c0f3cff: enh(modal): Add metric tooltips (v2.1.97)"
    - "6bd4c4d: enh(modal): Adjust CPC threshold (v2.1.96)"

# Notes for context rotation
context_rotation:
  last_rotation: "2024-12-13"
  next_rotation: "2024-12-20"
  items_ready_to_migrate:
    - "Top Criativos base implementation (2024-12-11) - pode migrar"
